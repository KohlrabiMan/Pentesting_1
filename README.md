# Project 7 - WordPress Pentesting

Time spent: **3** hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report

1. (Required) Unauthenticated Stored Cross-Site Scripting (XSS) (WPVDB 7945)
  - [ ] Summary: The error occurs due to the truncation of the comment once the MYSQL TEXT type size limit is reached (64MB -64,000 characters). The truncation leads to malformed HTML being generated on the page. Then the attacker uses the HTML tags as the payload of their attack. 
    - Vulnerability types:XSS CWE-79 
    - Tested in version:4.2
    - Fixed in version: 4.2.1
  - [ ] GIF Walkthrough: ![error_404](https://github.com/KohlrabiMan/Pentesting_1/blob/master/pentesting1.gif)
  - [ ] Steps to recreate: I ran wpscan on the 4.2 version of word press. Then I chose the first listed vulnerability "unauthenticated Stored Cross-Site Scripting (XSS)". Followed the links provided by the software. Found the proof of concept on https://klikki.fi/adv/wordpress2.html. Then using a character counter I generated the filler to exploit the truncation once I had over 64,000 (+64MB) characters, I commented it to to activate te XSS.  
  - [ ] Affected source code:- [Link 1](https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b)
2. (Required) Authenticated Stored Cross-Site Scripting (XSS)
  - [ ] Summary: A contributor or Author level account can insert specially formatted HTML containing JavaScript on a page or post. When the admin hovers their mouse over the link of the post the malicious script will be executed. 
    - Vulnerability types:XSS CWE-79
    - Tested in version:4.2
    - Fixed in version: 4.2.3
  - [ ] GIF Walkthrough: ![error_404](https://github.com/KohlrabiMan/Pentesting_1/blob/master/pentesting2.gif)
  - [ ] Steps to recreate: Create a new post or page. Then in the text include the XSS script (e.g. "<a href="[caption code=">]</a><a title=" onmouseover=alert('test')  ">link</a>"). Make sure not to leave spaces or other special characters with in the alert prompt, else it may lead to a nonextant URL. Then publish the post (assuming of course you avoided the aforementioned issue). Go to view the post and hover your mouse over the post to trigger the script. 
  - [ ] Affected source code: - [Link 2(reference)](https://klikki.fi/adv/wordpress3.html)
      - [Link 2](https://core.trac.wordpress.org/browser/branches/4.2/src/wp-includes/class-wp-editor.php?rev=33361)
3. (Required) Authenticated Shortcode Tags Cross-Site Scripting (XSS)
  - [ ] Summary: A Contributor or Author level can insert shortcode tags with XSS script. When the admin clicks the link of the post the XSS script will be executed.
    - Vulnerability types: XSS CWE-79
    - Tested in version:4.2
    - Fixed in version: 4.3.1
  - [ ] GIF Walkthrough: ![error_404](https://github.com/KohlrabiMan/Pentesting_1/blob/master/pentesting3.gif)
  - [ ] Steps to recreate: Create a new page or post. Then in the text include the XSS sxript (e.g. TEST!!![caption width="1" caption='<a href="' ">]</a><a href="http://onMouseOver='alert(1)'">Click me</a>). Watch for similar issues as those mentioned in pentesting example. Then publish the post. View and click the link to execute it. 
  - [ ] Affected source code: - [Link 3](https://github.com/WordPress/WordPress/commit/f72b21af23da6b6d54208e5c1d65ececdaa109c8)
4. (Optional)Comment Cross-Site Scripting (XSS)
  - [ ] Summary: Unauthenticated users can execute remote code assuming commenting is allowed, due to CSRF protection being mishandled via incorrect optimization of the search engine, leading to XSS. That can be used to escalate ones priveleges. Allowing the malicious actor to tamper with .php files. 
    - Vulnerability types: XSS CWE-79
    - Tested in version: 4.2
    - Fixed in version: 5.1.1
  - [ ] GIF Walkthrough: ![error_404](https://github.com/KohlrabiMan/Pentesting_1/blob/master/pentesting_4.gif)
  - [ ] Steps to recreate: Insert a XSS attack via JavaScript within the commenton a post and submit to execute XSS script. 
  - [ ] Affected source code: [Link 4](https://developer.wordpress.org/reference/classes/wp_comment/)
1. (Optional) Vulnerability Name or ID
  - [ ] Summary: 
    - Vulnerability types:
    - Tested in version:
    - Fixed in version: 
  - [ ] GIF Walkthrough: 
  - [ ] Steps to recreate: 
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php) 

## Assets

List any additional assets, such as scripts or files

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [LiceCap](http://www.cockos.com/licecap/).

## Notes

Describe any challenges encountered while doing the work

## License

    Copyright [yyyy] [name of copyright owner]

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.